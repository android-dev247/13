<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
<title>代码编辑器</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif}
html,body{height:100%;background:#121212;color:#fff}
.bar{display:flex;gap:8px;padding:10px;background:#1e1e1e}
button{flex:1;padding:12px 6px;border:none;border-radius:6px;background:#4f46e5;color:#fff;font-size:16px}
#code{width:100%;height:40vh;background:#1e1e1e;color:#fff;padding:12px;font-size:15px;resize:none;border:none;outline:none}
#preview{width:100%;height:35vh;background:#fff;border:none}
#log{height:15vh;background:#181818;padding:10px;font-size:13px;overflow-y:auto;color:#ddd}
.success{color:#22c55e}
.error{color:#ef4444}
</style>
</head>
<body>

<div class="bar">
  <button onclick="runCode()">运行</button>
  <button onclick="clearCode()">清空</button>
  <button onclick="saveFile()">保存</button>
</div>

<textarea id="code"></textarea>
<iframe id="preview"></iframe>
<div id="log"></div>

<script>
const code = document.getElementById('code');
const preview = document.getElementById('preview');
const log = document.getElementById('log');

function showLog(text, type){
  let line = document.createElement('div');
  line.className = type;
  line.textContent = text;
  log.appendChild(line);
  log.scrollTop = log.scrollHeight;
}

function runCode(){
  log.innerHTML = '';
  try {
    let blob = new Blob([code.value], {type:'text/html'});
    preview.src = URL.createObjectURL(blob);
    showLog('运行成功','success');
  }catch(e){
    showLog('错误：'+e.message,'error');
  }
}

function clearCode(){
  code.value = '';
  log.innerHTML = '';
}

function saveFile(){
  try {
    let blob = new Blob([code.value], {type:'text/html'});
    let url = URL.createObjectURL(blob);
    let a = document.createElement('a');
    a.download = '我的网页.html';
    a.href = url;
    a.click();
    setTimeout(()=>URL.revokeObjectURL(url), 500);
    showLog('已保存：我的网页.html','success');
  }catch(e){
    showLog('保存失败：'+e.message,'error');
  }
}

// 只给默认示例，不自动运行！
code.value = `<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>我的网页</title>
</head>
<body>
<h1>你好，世界</h1>
</body>
</html>`;
</script>

</body>
</html>
